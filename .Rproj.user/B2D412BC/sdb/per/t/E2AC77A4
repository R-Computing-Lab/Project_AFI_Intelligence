{
    "contents" : "####### ORGANIZATION  #######\nfile_drive= \"C:\"\n#file_drive=\"E:\"\n\n#directory=\"/Dropbox/Current Projects/DeLongis/Alameda Survival Manuscript/Alameda Data and Initial Code\"; setwd(paste0(file_drive,directory))\ndirectory<-getwd()\ncontent_folder = paste0(directory,\"/content\")\ndata_folder = paste0(content_folder,\"/data\")\ngraphics_folder = paste0(directory,\"/graphics\")\nmplus_folder = paste0(content_folder,\"/mplusautomation\")\ntables_folder = paste0(content_folder,\"/tables\")\nslides_folder = paste0(content_folder,\"/slides\")\n\n####### LIBRARIES #######\nlibrary(knitr)\nlibrary(ggplot2)\nlibrary(effects)\nlibrary(stargazer)\nlibrary(Hmisc)\nlibrary(foreign)\nlibrary(matrixStats)\nlibrary(survival)\nlibrary(beepr)\n####### FUNCTIONS #######\nsource(\"https://raw.githubusercontent.com/smasongarrison/Functions/master/Mason_Functions.R\")\n\n####### OPTIONS #######\noptions(width=60)\nopts_chunk$set(size=\"small\")\n#knit_hooks$set(source=listing, output=listing)\n#options(warn=-1) #Warnings Off\nset.seed(12345)\n\n####### DATA #######\n\n\n## ISPCR DATA ##\noptions(warn=-1) ## Warnings Off\n\nDS_1965<- read.dta(paste0(content_folder,\"/ICPSR Original Files/DS_1965/06688-0001-Data.dta\"))\n#capture.output(describe(DS_1965),file=paste0(content_folder,\"/ICPSR Original Files/describe_1965.txt\"))\n\nDS_1974<- read.dta(paste0(content_folder,\"/ICPSR Original Files/DS_1974/06838-0001-Data.dta\"))\n#capture.output(describe(DS_1974),file=paste0(content_folder,\"/ICPSR Original Files/describe_1974.txt\"))\n\nDS_Mort_74 <-  read.dta(paste0(content_folder,\"/ICPSR Original Files/DS_Mort_74/06838-0002-Data.dta\"))\n#capture.output(describe(DS_Mort_74),file=paste0(content_folder,\"/ICPSR Original Files/describe_Mort_74.txt\"))\n\nDS_1994<- sasxport.get(paste0(content_folder,\"/ICPSR Original Files/DS_1994/03083-0003-Data.xpt\"))\n#capture.output(describe(DS_1994),file=paste0(content_folder,\"/ICPSR Original Files/describe_1994.txt\"))\n\nDS_1999<- sasxport.get(paste0(content_folder,\"/ICPSR Original Files/DS_1999/04432-0001-Data.xpt\"))\n#capture.output(describe(DS_1999),file=paste0(content_folder,\"/ICPSR Original Files/describe_1999.txt\"))\n\nDS_Mort_99 <- sasxport.get(paste0(content_folder,\"/ICPSR Original Files/DS_Mort_99/04432-0002-Data.xpt\"))\n#capture.output(describe(DS_Mort_99),file=paste0(content_folder,\"/ICPSR Original Files/describe_Mort_99.txt\"))\n\noptions(warn=0) ## Warnings On\n# MATCH\ndata<-data.frame(DS_1965[1])\ndata$CP_ID = substr(DS_1965$RESP_ID,0,6)\nDS_1965<-merge(data,DS_1965,by.x=\"RESP_ID\", by.y=\"RESP_ID\", all=T)\nDS_1974<-merge(data,DS_1974,by.x=\"RESP_ID\", by.y=\"ID_1\", all=T)\nDS_Mort_74<-merge(data,DS_Mort_74,by.x=\"RESP_ID\", by.y=\"ID\", all=T)\n#Note DS_1994 has both 1994 and 1995 data\n#if ends in 9, then variable is from 1994, if ends in 5, then is from 1995\nDS_1994<-merge(data,DS_1994,by.x=\"RESP_ID\", by.y=\"id\", all=T)\nDS_1999<-merge(data,DS_1999,by.x=\"RESP_ID\", by.y=\"id\", all=T)\nDS_Mort_99<-merge(data,DS_Mort_99,by.x=\"RESP_ID\", by.y=\"id\", all=T)\n\n\nDS_1965$BMI<-(703*DS_1965$WEIGHT)/(DS_1965$HOWTALL^2)\n\n\n# TRIM\nDS_1965_trimmed<-data.frame(DS_1965[1:5],DS_1965[17],DS_1965[147:151],DS_1965[287],DS_1965$PHYS_ACT,DS_1965$EXERCISE,DS_1965$BMI,DS_1965$SPORTS,DS_1965$SWIMWALK)\nDS_1974_trimmed<-data.frame(DS_1974[1:6],DS_1974[456:466],DS_1974[506:508],DS_1974[546:548],DS_1974$MOREACT,DS_1974$EXER7,DS_1974$SWIMWLK7,DS_1974$SPORTS7)\nDS_Mort_74_trimmed<-DS_Mort_74\nDS_1994_trimmed<-data.frame(DS_1994[1:3],DS_1994[589:601],DS_1994[791:796],DS_1994[903:905],DS_1994$exer9,DS_1994$exer5,DS_1994$swim9,DS_1994$sports9,DS_1994$swim5,DS_1994$sports5)\nDS_1999_trimmed<-data.frame(DS_1999[1:3],DS_1999[538:542],DS_1999[754:756],DS_1999$qxdate0,DS_1999$exer0,DS_1999$sports0,DS_1999$swim0) ##Note that swim0 is just swimming\nDS_Mort_99_trimmed<-DS_Mort_99\n\n# RENAME\nnames(DS_1965_trimmed)<-c(\"RESP_ID\",\"CP_ID\",\"SEX_65\",\"AGE_65\",\"RELATION_65\",\"FAM_COMP_65\",\"MARRIED_65\", \"DIVORCED_65\",\"MARR_AGE_65\",\"STATUS_65\",\"YRS_MARR_65\",\"QMO_65\",\"RELATIVE_ACTIVITY_65\",\"EXERCISE_65\",\"BMI_65\",\"SPORTS_65\",\"SWIMWALK_65\")\nDS_1965_trimmed$QYR_65<-1965\nnames(DS_1974_trimmed)<-c(\"RESP_ID\",\"CP_ID\",\"SEX_74\",\"AGE_74\",\"RACE\",\"REL2HEAD_74\",\"MARITAL_74\",\"NMARRY_74\",\"MAR1AGE_74\",\"MAR1YRS_74\",\"MAR1END_74\",\"MAR2AGE_74\",\"MAR2YRS_74\",\"MAR2END_74\",\"MAR3AGE_74\",\"MAR3YRS_74\",\"MAR3END_74\" ,\"BMO_74\", \"BDAY_74\", \"BYR_74\",\"QMO_74\",\"QDAY_74\",\"QYR_74\",\"RELATIVE_ACTIVITY_74\",\"EXERCISE_74\",\"SWIMWALK_74\",\"SPORTS_74\")\n\nnames(DS_Mort_74_trimmed)<- c(\"RESP_ID\",\"CP_ID\",\"DMO_74\",\"DDAY_74\" ,\"DYR_74\",\"ICD9_74\",\"RESP_74\")\n\nnames(DS_1994_trimmed)<- c(\"RESP_ID\",\"CP_ID\",\"SEX_94\",\"MARRIED_94\",\"LIVTOG_94\",\"MARITAL_94\",\"NMARRY_94\",\"MAR1AGE_94\",\"MAR1YRS_94\",\"MAR1END_94\",\"MAR2AGE_94\",\"MAR2YRS_94\",\"MAR2END_94\",\"MAR3AGE_94\",\"MAR3YRS_94\",\"MAR3END_94\",\"BDAY_94\",\"BMO_94\",\"BYR_94\",\"QMO_94\",\"QDAY_94\",\"QYR_94\",\"QMO_95\",\"QDAY_95\",\"QYR_95\",\"EXERCISE_94\",\"EXERCISE_95\",\"SWIM_94\",\"SPORTS_94\",\"SWIM_95\",\"SPORTS_95\")      \nnames(DS_1999_trimmed)<- c(\"RESP_ID\",\"CP_ID\",\"CASID\", \"MARRIED_99\",\"LIVTOG_99\",\"MARITAL_99\",\"NMARRY_99\", \"MARDATA_99\",\"BMO_99\",\"BDAY_99\",\"BYR_99\",\"QDATE_99\",\"EXERCISE_99\",\"SPORTS_99\",\"SWIM_99\")\n\nnames(DS_Mort_99_trimmed)<-c(\"RESP_ID\",\"CP_ID\",\"ICD9_99\",\"ECODE_99\",\"DMO_99\",\"DDAY_99\",\"DYR_99\")  \n\n# MERGE\ndata<-merge(DS_1965_trimmed,DS_1974_trimmed,by=c(\"RESP_ID\",\"CP_ID\"), all=T)\ndata<-merge(data,DS_Mort_74_trimmed,by=c(\"RESP_ID\",\"CP_ID\"), all=T)\ndata<-merge(data,DS_1994_trimmed,by=c(\"RESP_ID\",\"CP_ID\"), all=T)\ndata<-merge(data,DS_1999_trimmed,by=c(\"RESP_ID\",\"CP_ID\"), all=T)\ndata<-merge(data,DS_Mort_99_trimmed,by=c(\"RESP_ID\",\"CP_ID\"), all=T)\n\n######### Variable Creation \n#Physical activity - was constructed by the sum of three items which asked respondents to indicate the frequency that they took long walks or swam, participated in active sports and did physical exercises.  Responses for each item ranged from ‘never’=0, sometimes’=1 and often’=2.  (Kaplan Baltrus, & Raghunathan, 2007)\ndetachAllData()\n\n\n\nattach(data)\n\nwrite.csv(data.frame(SWIMWALK_65,\n           SWIMWALK_74,\n           SPORTS_65,\n           SPORTS_74,\n           EXERCISE_65,\n           EXERCISE_74,SWIM_94,SPORTS_94,EXERCISE_94,\n           SWIM_95,SPORTS_95,EXERCISE_95,\n           SWIM_99,SPORTS_99,EXERCISE_99), file =paste0(content_folder,\"/ICPSR Original Files/activity.csv\"))\nactivity <- read.csv(paste0(content_folder,\"/ICPSR Original Files/activity.csv\"), stringsAsFactors=FALSE)\ndetachAllData()\nattach(activity)\n\n  frame<-data.frame(SWIMWALK_65\t,\n             SWIMWALK_74\t,\n             SPORTS_65\t,\n             SPORTS_74\t,\n             EXERCISE_65\t,\n             EXERCISE_74, stringsAsFactors=FALSE)\n  for (i in 1:length(frame)){\n    x<-frame[[i]]\n    x[x==\"OFTEN\"] <- 2\n    x[x==\"SOMETIMES\"] <- 1\n    x[x==\"NEVER\"] <- 0\n    data$x<-as.numeric(x)\n    names(data)[names(data) == 'x']<-paste0(\"r\",names(frame[i]))\n  }\n\nframe<-data.frame(SWIM_94,SPORTS_94,EXERCISE_94,\n                          SWIM_95,SPORTS_95,EXERCISE_95,\n                          SWIM_99,SPORTS_99,EXERCISE_99, stringsAsFactors=FALSE)\n\n\nfor (i in 1:length(frame)){\n  x<-frame[[i]]\n  x[x==1] <- -1\n  x[x==2] <- -2\n  x[x==3] <- 0\n  x[x==-1] <- 2\n  x[x==-2] <- 1\n  data$x<-as.numeric(x)\n  names(data)[names(data) == 'x']<-paste0(\"r\",names(frame[i]))\n}\ndetachAllData()\nattach(data)\ndata$rACTIVE_65<- rowMeans(data.frame(rSWIMWALK_65,rSPORTS_65,rEXERCISE_65),na.rm=TRUE)\ndata$rACTIVE_74<- rowMeans(data.frame(rSWIMWALK_74,rSPORTS_74,rEXERCISE_74),na.rm=TRUE)\ndata$rACTIVE_94<- rowMeans(data.frame(rSWIM_94,rSPORTS_94,rEXERCISE_94),na.rm=TRUE)\ndata$rACTIVE_95<- rowMeans(data.frame(rSWIM_95,rSPORTS_95,rEXERCISE_95),na.rm=TRUE)\ndata$rACTIVE_99<- rowMeans(data.frame(rSWIM_99,rSPORTS_99,rEXERCISE_99),na.rm=TRUE)\ndetachAllData()\nattach(data)\ndata$rACTIVE<- rowMeans(data.frame(rACTIVE_99,rACTIVE_95,rACTIVE_94,rACTIVE_74,rACTIVE_65),na.rm=TRUE)\ndata$rACTIVE_early <- rowMeans(data.frame(rACTIVE_65,rACTIVE_74),na.rm=TRUE)\ndetach(data)\n\n####### TIME EVENT DATES #######\ndata$BMO_99[data$BMO_99 == 99]<- NA\ndata$BMO_94[data$BMO_94 == 99]<- NA\ndata$BMO_94<-match(data$BMO_94,month.name)\ndata$BMO_99<-match(data$BMO_99,month.name)\ndata$BMO_74<-match(data$BMO_74,month.name)\ndata$DMO_74<-match(data$DMO_74,month.name)\ndata$BDAY_99[data$BDAY_99 == 99]<- NA\ndata$BDAY_94[data$BDAY_94 == 99]<- NA\ndata$BDAY_74[data$BDAY_74 == 99]<- NA\n\n## CONVERT ##\n#AGE INTO APPROXIMATE YEAR BORN\ndata$BYR_65<- 1965 - data$AGE_65\n\n#FROM LAST TWO DIGITS TO FOUR DIGITS\n#DOCUMENTATION SAYS MAX YEAR = 1948; MIN YEAR  APRROX 1890\ndata$BYR_74_2<-NA\ndata$BYR_74_2[data$BYR_74 > 90 & !is.na(data$BYR_74)]<- data$BYR_74[data$BYR_74 > 90 & !is.na(data$BYR_74)]\ndata$BYR_74_2<-data$BYR_74_2+1800\ndata$BYR_74_1[data$BYR_74 < 70 & !is.na(data$BYR_74)]<- data$BYR_74[data$BYR_74 < 70 & !is.na(data$BYR_74)]\ndata$BYR_74_0<-data$BYR_74_1+1900\ndata$BYR_74_0[is.na(data$BYR_74_1)]<-data$BYR_74_2[is.na(data$BYR_74_1)]\ndata$BYR_74<-data$BYR_74_0\ndetachAllData()\n\n\n\nattach(data)\n#Birth Month\nBMO_frame<-data.frame(BMO_99,BMO_94,BMO_74)\ndata$BMO<-RowMedians(BMO_frame,0)\ncor_1star(BMO_frame)\n\n#Birth Day\nBDAY_frame<-data.frame(as.numeric(BDAY_99),as.numeric(BDAY_94),as.numeric(BDAY_74))\ndata$BDAY<-RowMedians(BDAY_frame,0)\ncor_1star(BDAY_frame)\n#options(warn=0) ## Warnings On\n\n#Birth Year\nBYR_frame<-data.frame(as.numeric(BYR_99),as.numeric(BYR_94),as.numeric(BYR_74),as.numeric(BYR_65))\ndata$BYR<-RowMedians(BYR_frame,0)\ncor_1star(BYR_frame)\n\n#Death Month\nDMO_frame<-data.frame(as.numeric(DMO_99),as.numeric(DMO_74))\ndata$DMO<-RowMedians(DMO_frame,0)\ncor_1star(DMO_frame)\n\n#Death Day\nDDAY_frame<-data.frame(as.numeric(DDAY_99),as.numeric(DDAY_74))\ndata$DDAY<-RowMedians(DDAY_frame,0)\ncor_1star(DDAY_frame)\nCor((BYR_frame),5)\n#Death Year\nDYR_frame<-data.frame(as.numeric(DYR_99),as.numeric(DYR_74))\ndata$DYR<-RowMedians(DYR_frame,0)\ncor_1star(DYR_frame)\ndetachAllData()\n##cleaning\n\ndata$QYR_99<-substrRight(data$QDATE_99,4)\ndata$QDAY_99<-substrRight(data$QDATE_99,2,4)\ndata$QMO_99<-substrRight(data$QDATE_99,2,6)\n\ndata$DMO_NA<-0\ndata$DMO_NA[is.na(data$DMO)]<-1\ndata$BMO_NA<-0\ndata$BMO_NA[is.na(data$BMO)]<-1\n\ndata$BDAY_NA<-0\ndata$BDAY_NA[is.na(data$BDAY)]<-1\ndata$DDAY_NA<-0\ndata$DDAY_NA[is.na(data$DDAY)]<-1\n\ndata$BYR_NA<-0\ndata$BYR_NA[is.na(data$BYR)]<-1\n\ndata$DYR_NA<-0\ndata$DYR_NA[is.na(data$DYR)]<-1\n\n#Determine Mortality Status\ndata$Alive_74<-NA\ndata$Alive_74[data$RESP_74=='COMPLETED QUESTIONNAIRE RETURNED']<- 1\ndata$Alive_74[data$RESP_74=='R REFUSED WHEN CONTACTED BY INTERVIEWR']<- 1\ndata$Alive_74[data$RESP_74=='R UNABLE TO COMPLETE Q:ILL,SENILE,LANG']<- 1\ndata$Alive_74[data$RESP_74=='BLANK Q RETURNED/CERTFIED LETTER REFUS']<- 1\ndata$Alive_74[data$RESP_74=='R TELEPHONED OR WROTE REFUSAL']<- 1\ndata$Alive_74[data$RESP_74=='UNUSABLE QUESTIONNAIRE RETURNED']<- 1\ndata$Alive_74[!is.na(data$DYR_74)]<- 0\n\ndata$Alive_94<-NA\ndata$Alive_94[!is.na(data$QMO_94)|!is.na(data$QDAY_94)|!is.na(data$QYR_94)]<-1\ndata$Alive_94[!is.na(DS_1994$qxdate9)]<-1\n\ndata$Alive_95<-NA\ndata$Alive_95[!is.na(data$QMO_95)|!is.na(data$QDAY_95)|!is.na(data$QYR_95)]<-1\ndata$Alive_95[!is.na(DS_1994$qxdate9)]<-1\n\ndata$Alive_99<-NA\ndata$Alive_99[!is.na(data$QMO_99)|!is.na(data$QDAY_99)|!is.na(data$QYR_99)]<-1\ndata$Alive_99[!is.na(data$DYR_99)]<- 0\n\ndata$DMO_fill<-data$DMO\ndata$DMO_fill[is.na(data$DMO)]<-6\ndata$BMO_fill<-data$BMO\ndata$BMO_fill[is.na(data$BMO)]<-6\n\ndata$DDAY_fill<-data$DDAY\ndata$DDAY_fill[is.na(data$DDAY)]<-15\ndata$BDAY_fill<-data$BDAY\ndata$BDAY_fill[is.na(data$BDAY)]<-15\n\n\n###DATES\n#BirthDate\ndata$BDate<-NA\ndata$BDate <- as.Date(paste(data$BMO_fill, data$BDAY_fill,data$BYR, sep = \".\" )  , format = \"%m.%d.%Y\" )\n\n#DeathDate\ndata$DDate <- as.Date(paste(data$DMO_fill, data$DDAY_fill,data$DYR, sep = \".\" ), format = \"%m.%d.%Y\" )\n\n#Questionaire Date\n#1965\ndata$QMO_65_fill<-data$QMO_65\ndata$QMO_65_fill[is.na(data$QMO_65_fill)]<-Median(data$QMO_65,0)\ndata$QDATE_65<-as.Date(paste0(as.numeric(data$QMO_65_fill),\".15.\",data$QYR_65)  , format = \"%m.%d.%Y\" )\n\n#1974\ndata$QMO_74_fill<-data$QMO_74\ndata$QMO_74_fill[is.na(data$QMO_74_fill)]<-Median(data$QMO_74,0)\ndata$QDAY_74_fill<-data$QDAY_74\ndata$QDAY_74_fill[is.na(data$QDAY_74_fill)]<-Median(data$QDAY_74,0)\ndata$QDATE_74<-as.Date(paste0(as.numeric(data$QMO_74_fill),\".\", data$QDAY_74,\".19\",data$QYR_74)  , format = \"%m.%d.%Y\" )\n\n#1994\ndata$QMO_94_fill<-data$QMO_94\ndata$QMO_94_fill[is.na(data$QMO_94_fill)]<-Median(data$QMO_94,0)\ndata$QDAY_94_fill<-data$QDAY_94\ndata$QDAY_94_fill[is.na(data$QDAY_94_fill)]<- Median(data$QDAY_94,0)\n\ndata$QDATE_94<-as.Date(paste(data$QMO_94_fill, data$QDAY_94_fill,data$QYR_94, sep = \".\" )  , format = \"%m.%d.%Y\" )\n\n#1995\ndata$QMO_95_fill<-data$QMO_95\ndata$QMO_95_fill[is.na(data$QMO_95_fill)]<-Median(data$QMO_95,0)\ndata$QDAY_95_fill<-data$QDAY_95\ndata$QDAY_95_fill[is.na(data$QDAY_95_fill)]<- Median(data$QDAY_95,0)\ndata$QDATE_95<-as.Date(paste(data$QMO_95_fill, data$QDAY_95_fill,data$QYR_95, sep = \".\" )  , format = \"%m.%d.%Y\" )\n\n#1999\ndata$QMO_99_fill<-data$QMO_99\ndata$QMO_99_fill[is.na(data$QMO_99_fill)]<-Median(data$QMO_99,0)\ndata$QDAY_99_fill<-data$QDAY_99\ndata$QDAY_99_fill[is.na(data$QDAY_99_fill)]<-Median(data$QDAY_99,0)\n\n\ndata$QDATE_99<-as.Date(paste(data$QMO_99_fill, data$QDAY_99_fill,data$QYR_99, sep = \".\" )  , format = \"%m.%d.%Y\" )\n\ndata$Mort_Event<-0\ndata$Mort_Event[!is.na(data$DDate)]<-1\n\ndata$EventDate <- data$DDate\n\ndata$EventDate[data$Mort_Event==0]<-data$QDATE_65[data$Mort_Event==0]\ndata$EventDate[data$Mort_Event==0 & data$Alive_74==1 & !is.na(data$QDATE_74)]<-data$QDATE_74[data$Mort_Event==0 & data$Alive_74==1 & !is.na(data$QDATE_74)]\ndata$EventDate[data$Mort_Event==0 & data$Alive_94==1 & !is.na(data$QDATE_94)]<-data$QDATE_94[data$Mort_Event==0 & data$Alive_94==1 & !is.na(data$QDATE_94)]\ndata$EventDate[data$Mort_Event==0 & data$Alive_95==1 & !is.na(data$QDATE_95)]<-data$QDATE_95[data$Mort_Event==0 & data$Alive_95==1 & !is.na(data$QDATE_95)]\ndata$EventDate[data$Mort_Event==0 & data$Alive_99==1 & !is.na(data$QDATE_99)]<-data$QDATE_99[data$Mort_Event==0 & data$Alive_99==1 & !is.na(data$QDATE_99)]\ndata$EventDate[is.na(data$EventDate)]<-data$Age_65[is.na(data$EventDate)]\n\ndata$Mort_End<-as.numeric((data$EventDate - data$BDate)/365.25)\ndata$Mort_Start<-as.numeric((data$QDATE_65- data$BDate)/365.25)\ndetachAllData()\n\n\n\n\n\n######### Marriage Status ###############\n\n\n\n###Validate\n#data_2<-data.frame(DS_1965[1])\n#data_2$CP_ID = substr(DS_1965$RESP_ID,0,6)\n#Alameda <- read.csv(paste0(directory,\"/Alameda.csv\"))\n#Alameda <-merge(data_2,Alameda,by.x=\"RESP_ID\", by.y=\"ID\", all=T)\n#Alameda$J_time<-NA;Alameda$J_time<-as.numeric(Alameda$J_time)\n#for (i in 1:length(Alameda[1])){\n#Alameda$J_time[i]<- min(Alameda$AGE[i] + 35, Alameda$MortAGE[i], na.rm=TRUE)\n#}\n\n#Cor(data.frame(Alameda$J_time,data$Mort_End),5)\n#Mean(Alameda$J_time-data$Mort_End)\n\n######### CLEAN UP ###############\nrm(activity);rm(frame);rm(DS_1965);rm(BDAY_frame);rm(BMO_frame);rm(DS_1974);rm(DS_1965_trimmed);rm(DS_1974_trimmed);rm(DS_1994);rm(DS_1994_trimmed);rm(DS_1999);rm(DS_1999_trimmed);rm(DS_Mort_74);rm(DS_Mort_74_trimmed);rm(DS_Mort_99);rm(DS_Mort_99_trimmed);rm(DDAY_frame);rm(DMO_frame);rm(DYR_frame);rm(BYR_frame)\n\n\n####### MARRIED COUPLE SUBSET #######\n\nID_List<-unique(unlist(data$CP_ID))\nMarried_Subset<-data[data$RELATION_65=='HEAD OF HOUSEHOLD'|data$RELATION_65=='WIFE',]\nMarried_Subset<-Married_Subset[Married_Subset$STATUS_65=='MARRIED',]\nwrite.csv(Married_Subset, file =paste0(content_folder,\"/ICPSR Original Files/subset.csv\"))\nMarried_Subset <- read.csv(paste0(content_folder,\"/ICPSR Original Files/subset.csv\"), stringsAsFactors=FALSE)\nval<-data.frame(matrix(0, nrow= length(ID_List)*2, ncol=14))\nval[val==0]<-NA\nnames(val)<-c(\"CP_ID\",\"RESP_ID\",\"Mort_Start\",\"Mort_End\",\n              \"Mort_Event\",\"A_ACT_65\",\"A_ACT_74\",\"A_ACT_E\",\"P_ACT_65\",\"P_ACT_74\",\"P_ACT_E\",\"P_BMI_65\",\"A_BMI_65\",\"MALE\")\nrow=1\nfor (i in 1:length(ID_List)){\ncouple <- subset(Married_Subset, Married_Subset$CP_ID==ID_List[i])\nmale <- subset(couple, couple$SEX_65==\"MALE\")\nfemale <- subset(couple, couple$SEX_65==\"FEMALE\")\nif(nrow(female)>0){\nval[row,1] <- female$CP_ID\nval[row,2] <- female$RESP_ID\nval[row,3] <- female$Mort_Start\nval[row,4] <- female$Mort_End\nif (female$Mort_End-female$Mort_Start==0){\n  val[row,4] <- female$Mort_End +.5\n}\n\nval[row,5] <- female$Mort_Event\nval[row,6] <- female$rACTIVE_65\nval[row,7] <- female$rACTIVE_74\nval[row,8] <- female$rACTIVE_early\nif(nrow(male)>0){\nval[row,9] <- male$rACTIVE_65\nval[row,10] <- male$rACTIVE_74\nval[row,11] <- male$rACTIVE_early\nval[row,12] <- male$BMI_65\n}\nval[row,13] <- female$BMI_65\nval[row,14] <- 0\n\nrow = row+1\n}\n\nif(nrow(male)>0){\n  val[row,1] <- male$CP_ID\n  val[row,2] <- male$RESP_ID\n  val[row,3] <- male$Mort_Start \n  val[row,4] <- male$Mort_End\n  if (male$Mort_End-male$Mort_Start==0){\n    val[row,4] <- male$Mort_End +.5\n  }\n  val[row,5] <- male$Mort_Event\n  val[row,6] <- male$rACTIVE_65\n  val[row,7] <- male$rACTIVE_74\n  val[row,8] <- male$rACTIVE_early\n  if(nrow(female)>0){\n    val[row,9] <- female$rACTIVE_65\n    val[row,10] <- female$rACTIVE_74\n    val[row,11] <- female$rACTIVE_early\n    val[row,12] <- female$BMI_65\n  }\n  val[row,13] <- male$BMI_65\n  val[row,14] <- 1\n  row = row+1\n}\n}\nwrite.csv(val, file =paste0(content_folder,\"/Data/Alameda_Actor_Partner.csv\"))\nbeep()\n\n######### CLEAN UP ###############\nrm(data);rm(female);rm(val);rm(couple);rm(male);rm(Married_Subset);rm(ID_List)\n",
    "created" : 1438801832259.000,
    "dirty" : false,
    "encoding" : "UTF-8",
    "folds" : "",
    "hash" : "2916036607",
    "id" : "E2AC77A4",
    "lastKnownWriteTime" : 1438464753,
    "path" : "C:/Dropbox/Current Projects/DeLongis/Alameda Survival Manuscript/Alameda Data and Initial Code/data_management.R",
    "project_path" : null,
    "properties" : {
    },
    "relative_order" : 2,
    "source_on_save" : false,
    "type" : "r_source"
}